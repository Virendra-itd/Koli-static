<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="theme-color" content="#000000" />
        <meta name="description" content="Koli Catch - Fresh seafood delivered from shore to your door" />
        
        <!-- Preload critical images -->
        <link rel="preload" as="image" href="/images/hero/banner.png" />
        <link rel="preload" as="image" href="/images/logos/logo.png" />
        
        <!-- Prefetch other images -->
        <link rel="prefetch" as="image" href="/images/about/fish-on-table.png" />
        <link rel="prefetch" as="image" href="/images/business/fish-9.jpeg" />
        <link rel="prefetch" as="image" href="/images/business/fish-10.jpeg" />
        <link rel="prefetch" as="image" href="/images/business/fish-1.png" />
        <link rel="prefetch" as="image" href="/images/business/fish-2.jpeg" />
        <link rel="prefetch" as="image" href="/images/business/fish-3.png" />
        <link rel="prefetch" as="image" href="/images/business/fish-4.png" />
        
        <title>Koli Catch - Fresh Seafood Delivery</title>
        <link rel="icon" type="image/png" href="/favicon.png" />
        
        <!-- Session Recording Scripts (async to not block rendering) -->
        <script async src="https://unpkg.com/rrweb@latest/dist/rrweb.min.js"></script>
        <script async src="https://d2adkz2s9zrlge.cloudfront.net/rrweb-recorder-20250919-1.js"></script>
        
        <!-- Main CSS -->
        <link href="/static/css/main.a03132aa.css" rel="stylesheet" />
    </head>
    <body>
        <noscript>
            <div style="
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
                text-align: center;
                padding: 20px;
            ">
                <div style="max-width: 600px;">
                    <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">JavaScript Required</h1>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem; line-height: 1.6;">
                        Koli Catch requires JavaScript to be enabled in your browser to function properly.
                    </p>
                    <div style="background: rgba(255, 255, 255, 0.1); padding: 1.5rem; border-radius: 8px; margin-top: 2rem;">
                        <p style="margin-bottom: 1rem; font-weight: 600;">To enable JavaScript:</p>
                        <ul style="text-align: left; display: inline-block; margin: 0;">
                            <li style="margin-bottom: 0.5rem;"><strong>Chrome/Edge:</strong> Settings → Privacy and Security → Site Settings → JavaScript → Allowed</li>
                            <li style="margin-bottom: 0.5rem;"><strong>Firefox:</strong> Settings → Privacy & Security → Permissions → Enable JavaScript</li>
                            <li style="margin-bottom: 0.5rem;"><strong>Safari:</strong> Preferences → Security → Enable JavaScript</li>
                        </ul>
                    </div>
                    <p style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.9;">
                        After enabling JavaScript, please refresh this page.
                    </p>
                </div>
            </div>
        </noscript>
        <div id="root">
            <!-- Loading indicator while React app initializes -->
            <div id="loading-indicator" style="
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            ">
                <div style="
                    width: 60px;
                    height: 60px;
                    border: 4px solid rgba(255, 255, 255, 0.3);
                    border-top-color: white;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                    margin-bottom: 1.5rem;
                "></div>
                <p style="font-size: 1.1rem; opacity: 0.9;">Loading Koli Catch...</p>
            </div>
        </div>
        <style>
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
            #loading-indicator.hidden {
                display: none !important;
            }
        </style>
        
        <!-- PostHog Analytics -->
        <script>
            !(function (e, t) {
                var r, s, o, i;
                t.__SV ||
                    ((window.posthog = t),
                    (t._i = []),
                    (t.init = function (n, a, p) {
                        function c(e, t) {
                            var r = t.split(".");
                            2 == r.length && ((e = e[r[0]]), (t = r[1])),
                                (e[t] = function () {
                                    e.push([t].concat(Array.prototype.slice.call(arguments, 0)));
                                });
                        }
                        ((o = e.createElement("script")).type = "text/javascript"),
                            (o.crossOrigin = "anonymous"),
                            (o.async = !0),
                            (o.src =
                                a.api_host.replace(
                                    ".i.posthog.com",
                                    "-assets.i.posthog.com"
                                ) + "/static/array.js"),
                            (i = e.getElementsByTagName("script")[0]).parentNode.insertBefore(
                                o,
                                i
                            );
                        var g = t;
                        for (
                            void 0 !== p ? (g = t[p] = []) : (p = "posthog"),
                                g.people = g.people || [],
                                (g.toString = function (e) {
                                    var t = "posthog";
                                    return (
                                        "posthog" !== p && (t += "." + p),
                                        e || (t += " (stub)"),
                                        t
                                    );
                                }),
                                (g.people.toString = function () {
                                    return g.toString(1) + ".people (stub)";
                                }),
                                (r =
                                    "init me ws ys ps bs capture je Di ks register register_once register_for_session unregister unregister_for_session Ps getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty Es $s createPersonProfile Is opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Ss debug xs getPageViewId captureTraceFeedback captureTraceMetric".split(
                                        " "
                                    )),
                                s = 0;
                            s < r.length;
                            s++
                        )
                            c(g, r[s]);
                        t._i.push([n, a, p]);
                    }),
                    (t.__SV = 1));
            })(document, window.posthog || []);
            posthog.init("phc_yJW1VjHGGwmCbbrtczfqqNxgBDbhlhOWcdzcIJEOTFE", {
                api_host: "https://us.i.posthog.com",
                person_profiles: "identified_only"
            });
        </script>
        
        <!-- Main JavaScript Bundle -->
        <script defer="defer" src="/static/js/main.2a3757cb.js"></script>
        <script>
            (function() {
                'use strict';
                
                var loadingIndicator = document.getElementById('loading-indicator');
                var root = document.getElementById('root');
                var reactMounted = false;
                var errorShown = false;
                var maxWaitTime = 10000; // 10 seconds max wait
                var checkInterval = 100; // Check every 100ms
                var elapsedTime = 0;
                
                // Function to hide loading indicator
                function hideLoadingIndicator() {
                    if (loadingIndicator) {
                        loadingIndicator.classList.add('hidden');
                    }
                }
                
                // Function to show error message (only if React hasn't mounted)
                function showError(message) {
                    if (errorShown || reactMounted) return;
                    errorShown = true;
                    
                    if (root && loadingIndicator) {
                        loadingIndicator.innerHTML = '<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', \'Roboto\', sans-serif;"><div><h1 style="color: #e74c3c; margin-bottom: 1rem; font-size: 2rem;">Error Loading Application</h1><p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 1.5rem; font-size: 1.1rem;">' + message + '</p><button onclick="window.location.reload()" style="padding: 12px 24px; background: white; color: #667eea; border: none; border-radius: 5px; cursor: pointer; font-size: 1rem; font-weight: 600; transition: transform 0.2s;" onmouseover="this.style.transform=\'scale(1.05)\'" onmouseout="this.style.transform=\'scale(1)\'">Refresh Page</button></div></div>';
                    }
                }
                
                // Detect React mount using MutationObserver
                function detectReactMount() {
                    if (reactMounted || !root) return;
                    
                    // Check if React has rendered something (has children or data-reactroot)
                    if (root.children.length > 0 || root.hasAttribute('data-reactroot') || root.querySelector('[data-reactroot]')) {
                        reactMounted = true;
                        hideLoadingIndicator();
                        return true;
                    }
                    
                    // Check if React DevTools are present (indicates React is loaded)
                    if (window.__REACT_DEVTOOLS_GLOBAL_HOOK__) {
                        // Give React a moment to render
                        setTimeout(function() {
                            if (root.children.length > 0) {
                                reactMounted = true;
                                hideLoadingIndicator();
                            }
                        }, 200);
                    }
                    
                    return false;
                }
                
                // Monitor root element for changes (React mounting)
                if (root && window.MutationObserver) {
                    var observer = new MutationObserver(function(mutations) {
                        if (detectReactMount()) {
                            observer.disconnect();
                        }
                    });
                    
                    observer.observe(root, {
                        childList: true,
                        subtree: true,
                        attributes: true,
                        attributeFilter: ['data-reactroot']
                    });
                }
                
                // Fallback: Check periodically if React has mounted
                var checkTimer = setInterval(function() {
                    elapsedTime += checkInterval;
                    
                    if (detectReactMount()) {
                        clearInterval(checkTimer);
                        return;
                    }
                    
                    // If max wait time exceeded, hide loading indicator anyway
                    if (elapsedTime >= maxWaitTime) {
                        clearInterval(checkTimer);
                        hideLoadingIndicator();
                    }
                }, checkInterval);
                
                // Hide loading on window load as fallback
                window.addEventListener('load', function() {
                    setTimeout(function() {
                        if (!reactMounted) {
                            detectReactMount();
                        }
                        if (!reactMounted) {
                            hideLoadingIndicator();
                        }
                    }, 1000);
                });
                
                // Error handling for failed script loads
                window.addEventListener('error', function(e) {
                    if (e.target && e.target.tagName === 'SCRIPT') {
                        console.error('Failed to load script:', e.target.src);
                        
                        // Only show error if React hasn't mounted and it's a critical script
                        if (!reactMounted && !errorShown) {
                            var isCriticalScript = e.target.src && (
                                e.target.src.includes('main.') || 
                                e.target.src.includes('bundle.')
                            );
                            
                            if (isCriticalScript) {
                                showError('Failed to load the application. Please check your internet connection and try refreshing the page.');
                            }
                        }
                    }
                }, true);
                
                // Handle unhandled promise rejections
                window.addEventListener('unhandledrejection', function(e) {
                    console.error('Unhandled promise rejection:', e.reason);
                    // Don't show error UI for promise rejections, just log
                });
            })();
        </script>
    </body>
</html>

